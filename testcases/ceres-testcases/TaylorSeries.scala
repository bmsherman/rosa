
import leon.Real
import Real._


object TaylorSeries {
   
  // Sim: [-1.425532517660864,0.9999999999999941]    (1.5543122344752192E-15)
  def cos(x: Real): Real = {
    require(-1.24 <= x && x <= 3.5)
    1 - (x*x)/2.0 + (x*x*x*x)/24.0 - (x*x*x*x*x*x)/720.0
  } ensuring (res => -1.43 <= res && res <= 1.0 && noise(res, 1e-12))

  // sin(x) * cos(x)
  // Sim: [-0.4920575622228202,216.8563439361969]    (1.7053025658242404E-13)
  def cos2(x: Real): Real = {// around 1.34
    require(-3.14 <= x && x <= 3.14)
    0.222687 - 0.895344*(x - 1.34) - 0.445375*(x - 1.34)*(x - 1.34) +
    0.596896*(x - 1.34)*(x - 1.34)*(x - 1.34) +
    0.148458*(x - 1.34)*(x - 1.34)*(x - 1.34)*(x - 1.34) -
    0.119379*(x - 1.34)*(x - 1.34)*(x - 1.34)*(x - 1.34)*(x - 1.34) 
  } ensuring (res => -0.5 <= res && res <= 217.0 && noise(res, 1e-12))

  //cos(sqrt(x + 7.8) *2*x)
  // Sim: [-59.62687322193541,0.9618440785087154]    (3.552713678800501E-14)
  def cos3(x: Real): Real = { //around -3.4
    require(-5.0 <= x && x <= -1.0)
    -0.126295 + 2.55374*(x + 3.4) + 0.982769*(x + 3.4)*(x + 3.4) -
    2.67303*(x + 3.4)*(x + 3.4)*(x + 3.4) -
    2.08817*(x + 3.4)*(x + 3.4)*(x + 3.4)*(x + 3.4) +
    0.438815*(x + 3.4)*(x + 3.4)*(x + 3.4)*(x + 3.4)*(x + 3.4)
  } ensuring (res => -60.0 <= res && res <= 1.0 && noise(res, 1e-12))

  // Sim: [1.000000000000040,5.215020510086066]    (1.7763568394002505E-15)
  def cosh6(x: Real): Real = {
    require(-1.23 <= x && x <= 2.34)
    1 + (x*x)/2.0 + (x*x*x*x)/24.0 + (x*x*x*x*x*x)/720.0
  } ensuring (res => 1.0 <= res && res <= 5.5 && noise(res, 1e-12))
  
  // Sim: [0.6786651176339717,2.986100724817679]    (1.3322676295501878E-15)
  def exOverCosx(x: Real): Real = {
    require(-1.5 <= x && x <= 0.8)
    1 + x + x*x + (2*x*x*x)/3.0 + (x*x*x*x)/2.0
  } ensuring (res => 0.7 <= res && res <= 3.0 && noise(res, 1e-12))

  // Sim: [-0.9756807032849710,0.9579886390597153]    (2.220446049250313E-16)
  def sin(x: Real): Real = {
    require(-1.35 <= x && x <= 1.28)
    x - (x*x*x)/6.0 + (x*x*x*x*x)/120.0 - (x*x*x*x*x*x*x)/5040.0
  } ensuring (res => -1.0 <= res && res <= 1.0 && noise(res, 1e-12))

  // sin(1.24*x - 0.087)
  // Sim: [-0.7796391511083967,1.000009916527744]    (1.1102230246251565E-15)
  def sin2(x: Real): Real = {//around 0.98
    require(-1.0 <= x && x <= 2.46)
    0.903643 + 0.531076*(x - 0.98) - 0.694721*(x - 0.98)*(x - 0.98) -
    0.136097*(x - 0.98)*(x - 0.98)*(x - 0.98) +
    0.0890169*(x - 0.98)*(x - 0.98)*(x - 0.98)*(x - 0.98) +
    0.0104631*(x - 0.98)*(x - 0.98)*(x - 0.98)*(x - 0.98)*(x - 0.98)
  } ensuring (res => -0.8 <= res && res <= 1.0 && noise(res, 1e-12))

  // sin(x) * sin(x)
  // Sim: [0.1053730907077877,3.589088717014549]    (5.773159728050814E-15)
  def sin3(x: Real): Real = { // around 1.34
    require(-1.0 <= x && x <= 3.14)
    0.947672 + 0.445375*(x - 1.34) - 0.895344*(x - 1.34)*(x - 1.34) -
    0.296916*(x - 1.34)*(x - 1.34)*(x - 1.34) +
    0.298448*(x - 1.34)*(x - 1.34)*(x - 1.34)*(x - 1.34) +
    0.0593833*(x - 1.34)*(x - 1.34)*(x - 1.34)*(x - 1.34)*(x - 1.34) 
  } ensuring (res => 0.1 <= res && res <= 3.6 && noise(res, 1e-12))
  
  // Sim: [-0.4653298002731128,5.136316766769693]    (2.6645352591003757E-15)
  /*def sinh7(x: Real): Real = {
    require(-0.45 <= x && x <= 2.34)
    x + (x*x*x)/6.0 + (x*x*x*x*x)/120.0 + (x*x*x*x*x*x*x)/5040.0
  } ensuring (res => -0.5 <= res && res <= 5.2 && noise(res) <= 1e-12)
  */

  // Sim: [1.168748495960413,2.068836443423501]    (8.881784197001252E-16)
  // Fails to time out
  def sqrt(x: Real): Real = { // around 3.14
    require(1.35 <= x && x <= 4.28)
    1.772 + 0.282166*(x - 3.14) - 0.0224655*(x - 3.14)*(x - 3.14) +
    0.0035773*(x - 3.14)*(x - 3.14)*(x - 3.14) -
    0.000712043*(x - 3.14)*(x - 3.14)*(x - 3.14)*(x - 3.14) +
    0.000158736*(x - 3.14)*(x - 3.14)*(x - 3.14)*(x - 3.14) 
  } ensuring (res => 1.0 <= res && res <= 2.4 && noise(res, 1e-12))
  

  // 0.0000272113 is not representable as Int/Int
  def sqrt2(x: Real): Real = { // around 7.98
    require(3.35 <= x && x <= 12.28)
    2.82489 + 0.176998*(x- 7.98) - 0.00554505*(x- 7.98)*(x- 7.98) +
    0.000347434*(x- 7.98)*(x- 7.98)*(x- 7.98) -
    0.0000272113*(x- 7.98)*(x- 7.98)*(x- 7.98)*(x- 7.98) 
  } ensuring (res => res <= 1.2)
  

  // sqrt(3*x - 0.3)
  // Sim: [0.2669926110387539,4.520059737484441]    (8.271161533457416E-15)
  def sqrt3(x: Real): Real = { // around 3.2
    require(3.35 <= x && x <= 12.28)
    3.04959 + 0.491869*(x - 3.2) - 0.0396669*(x - 3.2)*(x - 3.2) +
    0.00639788*(x - 3.2)*(x - 3.2)*(x - 3.2) -
    0.0012899*(x - 3.2)*(x - 3.2)*(x - 3.2)*(x - 3.2)
  } ensuring (res => 0.2 <= res && res <= 4.6 && noise(res, 1e-12))

  // Sim: [-2.527343255806877,2.527356134563472]    (8.881784197001252E-16)
  def tan5(x: Real): Real = {
    require(-1.3 <= x && x <= 1.3)
    x + (x*x*x)/3.0 + (2*x*x*x*x*x)/15.0
  } ensuring (res => -2.5 <= res && res <= 2.6 && noise(res, 1e-12))
  
}
